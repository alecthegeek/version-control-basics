<h1 id="overview">Overview</h1>

<p>This course is part of the material to support students and mentors using the Raspberry Pi educational computer.
The examples in this course have been tested #TODO on Debian Linux</p>

<h2 id="justification">Justification</h2>

<ol>
<li>Version Control (VC) is an important skill for developers and a prerequisite for developing quality software</li>
<li>Distributed Version Control Systems (DVCS) provide a useful platform for students to work together on educational projects</li>
</ol>

<h2 id="outcomes">Outcomes</h2>

<ol>
<li>Able to describe the benefits of using version control

<ol>
<li>Describe problems that can occur when groups of people work together on computer files during a project</li>
<li>Understand basic VC concepts and terminology &#8211; commit, commit history, change, branch, merge, commit message</li>
</ol></li>
<li>Can use Git for version control of new and existing projects, including working in a project group

<ol>
<li>Create a local repository (repo)</li>
<li>Commit a change or modification</li>
<li>Create a branch</li>
<li>Show the history</li>
<li>Show change differences using diff</li>
<li>Perform a merge</li>
<li>Push and fetch changes to and from a remote repo (For simplicty the git pull command is not taught)</li>
</ol></li>
</ol>

<h1 id="introduction">Introduction</h1>

<h2 id="whatisversioncontrolandhowdoversioncontrolsystemswork">What is Version Control and how do Version Control Systems work</h2>

<p>Version Control (VC) is a common practice used to track all the changes that occur to the files in a project over time. It needs a Version Control System (VCS) tool to work.</p>

<p>The way that a VCS works by recording a history of changes. What does that mean?</p>

<p>Every time a change is completed (for example fixing a bug in a project) the developer decides a logical &#8216;&#8216;save&#8217;&#8217;
point has been reached and will store all the file changes that make up the fix in the VCS database.</p>

<p>The term often used for a group or changes that belong together like this is a <strong>changeset</strong>.
As well as changing lines of code in source files there might be changes to
configuration files, documentation, graphic files and so on.</p>

<p>Along with the changes to the files the developer will be prompted by the VCS to provide a
description of the change with a <strong>commit message</strong> which is appended to the <strong>commit log</strong>.</p>

<p>The process of storing the changes in the VCS database
(usually refereed to as the <strong>repository</strong> or repo for short)
is called <strong>making a commit</strong>_.</p>

<p>The hard work in making a commit is done by the VCS,
all the developer does is issue the commit command and provide the commit message.
The VCS software calculates which files have changed since the last commit and what has changed.
It then stores these changes, plus the commit message, the date, time, name of the developer (committer),
commit message and other information in the repository.</p>

<p>Version Control is also sometimes refereed to as [http://en.wikipedia.org/wiki/Revision_control Revision Control]</p>

<h2 id="whyisversioncontrolissoimportant">Why is Version Control is so important</h2>

<p>Imagine a software project. It might have hundreds of files (for example source code, build scripts, graphics, design documents, plans etc.) and dozens of people working on the project making
different types of changes. There are several problems that will happen:</p>

<ol>
<li>Two people might be editing the same file at once and changes can be overwritten</li>
<li>After the project has been running for some time it&#8217;s very hard to understand how the project has evolved and what changes have been made.
How can we locate a problem that might have been introduced some time ago.
Just fixing the problem may not be enough, we probably also need to to understand the change that introduced it.</li>
<li>If two people want to change the same file one will have to wait for the other to finish, this is very inefficient</li>
<li>If two people people are making (long running) changes to the project it may take some time for the both sets of changes to be compatible with each other.
If the sane copy if the project is being updated with both sets of changes then the project may not work correctly or even compile</li>
</ol>

<p>There are three core things a VCS helps do:</p>

<ol>
<li>Answer the following questions: &#8220;What changes were made in the past?&#8221;, &#8220;Why were they made?&#8221; and &#8220;Who made them?&#8221; (via commit history and commit comments)

<ol>
<li>Individual developers find this information useful as part of their daily workflow and
it also helps organisations with their compliance and audit management</li>
</ol></li>
<li>Undo a half complete or incorrect change made in error and &#8220;roll back&#8221; to a previous version</li>
<li>Recreate a &#8220;snapshot&#8221; of the project as it was at some point in the past</li>
</ol>

<p>You may find the following additional reading useful in ontroducing core concepts: http://tom.preston-werner.com/2009/05/19/the-git-parable.html</p>

<h2 id="toolsavailable">Tools available</h2>

<ul>
<li>Distributed vs. Centralised

<ul>
<li>Modern VCS work on a distributed model (DVCS). This means that every member of the project team keeps a complete local copy of all the changes. The previous model, still widely used with tools like Subversion, is centralised. There is only one central database with all the changes and team members only have a copy of the change they are currently working on.</li>
</ul></li>
<li>Open Source and Commercial Tools</li>
<li>What the tools do

<ul>
<li>Commit history</li>
<li>Diff listing</li>
<li>Integrate with other tools (e.g. Ticket Systems, built Systems, project management etc.)</li>
</ul></li>
</ul>

<h1 id="anexampleusinggit">An example using Git</h1>

<p>Git (http://git-scm.com/) is very popular DVCS originally developed to maintain the GNU/Linux kernel source code (the operating system that usually runs on the Raspberry Pi). It is now used by many very large open
source projects and a lot of commercial development teams. Git is very flexible and has a reputation of being hard to use, but we are only going to concentrate on the ten or so commands you need to
be useful day to day.</p>

<p>There are many excellent tutorials for Git on the Internet. See the External References section below.</p>

<p>These examples assume that you are using Debian Linux on a Raspberry Pi and have downloaded the Python Snakes project from the [http://www.raspberrypi.org/game.tar.gz Raspberry Pi website] into a directory called <code>snakes</code>.
All the commands are issued from a terminal.
You can start the terminal from the LXDE GUI by #TODO&#8230;.. Initially this example assumes that the current directory is your home directory, which is the default when you start a terminal window.</p>

<h3 id="setupup">Setup up</h3>

<ol>
<li><p>Make sure you have the correct tools installed by typing the following commands:</p>

<pre><code>sudo apt-get install git git-gui git-gitk
</code></pre></li>
</ol>

<p>#TODO: See if kdiff3 works on RasPi and provide instructions for mergetool and difftool setup?</p>

<ol>
<li><p>Test the installation with the command</p>

<pre><code>git --version
</code></pre></li>
<li><p>you should see something like</p>

<pre><code>git version 1.7.10
</code></pre></li>
<li><p>Tell Git who you are (this is very important information and it recorded in every change in you make or commit)</p>

<pre><code>git config --global user.name &quot;My Name&quot;

git config --global user.email &quot;myname@mycollege.ed.uk&quot;
</code></pre></li>
</ol>

<p>You must of course substitute your own name and email address in the correct places.
Git records that information in a user configuration file called <code>.gitconfig</code> in your home directory</p>

<p>Linux and Mac OS X users should also run the command</p>

<pre><code>    git config --global core.autocrlf input
</code></pre>

<p>(MS Windows uers should issue the command <code>git config &#8211;global core.autocrlf true</code>).
See http://help.github.com/line-endings/ for details.</p>

<h3 id="startinganewprojectbycreatingarepo">Starting a new project by creating a repo</h3>

<p>The next thing we need to do it create an empty Git database, called a repo (short for repository) inside our snakes directory</p>

<pre><code>    cd snakes
    git init
    Initialized empty Git repository in /home/alec/snakes/.git/
</code></pre>

<p>Notice that the VC tool has created a hidden directory called <code>.git</code>.
In Linux all file and directory (folder) names that start with a &#8220;<code>.</code>&#8221; are normally hidden, but you can see them with the command <code>ls -A</code>.</p>

<p>Next we issue a status command.</p>

<pre><code>    git status
</code></pre>

<p>In Git all commands are typed after the word git (e.g. <code>git init</code> or <code>git status</code>).
The output from the status command is</p>

<pre><code>    # On branch master
    # 
    # Initial commit

    # Untracked files:
    #   (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)

    #   game/
    #   helloworld.py
    #   if.py
    #   maths.py
    #   variables.py
    #   while.py
    nothing added to commit but untracked files present (use &quot;git add&quot; to track)
</code></pre>

<p>We can ignore most of the detail for now. What important is that Git:</p>

<ol>
<li>Warns us that some files are not being controlled (untracked) by the VCS</li>
<li>Lists the files and directories with their status. We will see this change as we progress further in the example.</li>
</ol>

<h3 id="addtheprojectfilestoversioncontrol">Add the project files to version control</h3>

<p>Before changes are added to the repo database we have to decide what will be in the commit. There might be a many changes
in the files we are working on, but our changset is actually only a small number of changes.</p>

<p>Git has a novel solution to this called the index. Before a file change can be committed to the repo it is first
added to the index. As well as adding files to the index, files can be moved or deleted. Once all the parts of the
commit are complete a commit command is issued. The following examples are simple and for the time being you
should just excpect that before a commit is done changes are added to the index as the following example shows.</p>

<pre><code>    git add .
</code></pre>

<p>This command does not product any output by default so don&#8217;t be concerned if you get no messages. If you get a message
simaliar to <code>warning: CRLF will be replaced by LF &#8230;</code> then this is nornmal as well (some versions of
the Snakes project are provided in Windows format text files).</p>

<p>if we run the <code>git status</code> command now we get different output</p>

<pre><code>    # On branch master
    #
    # Initial commit
    #
    # Changes to be committed:
    #   (use &quot;git rm --cached &lt;file&gt;...&quot; to unstage)
    #
    #   new file:   game/game0.py
    #   new file:   game/game1.py
    #   new file:   game/game2.py
    #   new file:   game/game3.py
    #   new file:   game/game4.py
    #   new file:   game/snake.py
    #   new file:   helloworld.py
    #   new file:   if.py
    #   new file:   maths.py
    #   new file:   variables.py
    #   new file:   while.py
    #
</code></pre>

<p>This time each file that will be committed is listed, not just the directory, and the status has changed
from <code>untracked</code> to <code>new file</code>.</p>

<p>Now that the file contents have been added to the index we can commit these changes as our first commit</p>

<pre><code>    git commit -m &quot;Initial Commit&quot;
</code></pre>

<p>Git adds the files and related information to our repo and provides a rather verbose set of messages about what it
did</p>

<pre><code>    master (root-commit) cff14c5] Initial Commit
     11 files changed, 693 insertions(+)
     create mode 100755 game/game0.py
    .......___and so on___
</code></pre>

<p>Some intresting commands we can now run</p>

<pre><code>    git status

    # On branch master
    nothing to commit (working directory clean)
</code></pre>

<p>Another command worth running is <code>git log</code>, whch is currently very brief as we have only have one commit. Mine
looks like ths</p>

<pre><code>    commit 9b941110ffadf261fff069c0aa9ca6042e10422b
    Author: Alec Clews &lt;alecclews@gmail.com&gt;
    Date:   Mon May 14 20:47:43 2012 +1000

        Initial Commit
</code></pre>

<p>The meaning of the Author, Date and comment field should be obvious. The commit field will be explained later.</p>

<p>We now have our project under version control.</p>

<h3 id="makingachange">Making a change</h3>

<p>Now lets make a change. The first step is to create a work area in wich to make the change. In Git
(and many other VC tools) this dedicated workarea is called a <strong>branch</strong>. When you first create a repo
the defauly branch that is created is called <strong>master</strong>, but it&#8217;s important to know that there is nothing special
about master branch, it can be treated in exactly the same way as any branches you create yourself.</p>

<p>If you look at the output from the status command above you can see that we are currently using the master branch
in our working area.</p>

<p>What Change do I want to make? When I play the verion of snakes I have the rocks are represented by &#8220;Y&#8221; which
I want to change to &#8220;R&#8221;. The line in I need to change is in the file snake.py (lines 50 and 52 in my version).</p>

<p>Let&#8217;s create a branch to work on.</p>

<pre><code>    git branch make_rocks_R
</code></pre>

<p>No message means the command was succesful (note that spaces are not allowed in the branch name)</p>

<p>You can get a lit of all the branches with the <code>git branch</code> command</p>

<pre><code>      make_rocks_R
    * master
</code></pre>

<p>The asterix shows the current branch.</p>

<p>To make the <code>make_rocks_R</code> the current branch use the checkout command</p>

<pre><code>    git checkout make_rocks_R
    Switched to branch 'make_rocks_R'
</code></pre>

<p>Now <code>git branch</code> displays</p>

<pre><code>    * make_rocks_R
      master
</code></pre>

<p>At this point you make want to play snakes for a couple of minutes so that you will be able to see the difference later.
Use the command <code>python game/snake.py</code></p>

<ul>
<li>Changing the file</li>
</ul>

<p>Edit the file <code>game/snake.py</code> using your favourite text editor. In the version of snakes I had there are two changes to
make; a comment on line 50; and the actual code on line 52. Save the changes and test the game by playing it again.</p>

<ul>
<li>Showing the diff</li>
</ul>

<p>So let&#8217;s see what has changed. Git can privide a nice listing
+ Committing the change
+ Showing the history
+ Branches</p>

<h1 id="workingwithothers">Working with others</h1>

<ul>
<li>Remote repos</li>
<li>Merging</li>
<li>Patches</li>
</ul>

<h1 id="externalreferences">External References</h1>

<p>Several videos that introduce the basic ideas of version control can be found at http://git-scm.com/videos or on YouTube at:</p>

<ul>
<li><p>Episode 1: http://www.youtube.com/watch?v=K2wBGt-j0fE</p></li>
<li><p>Episode 2: http://www.youtube.com/watch?v=0BIGxolZQHo</p></li>
<li><p>Episode 3: http://www.youtube.com/watch?v=ojVzmIp6Xv0</p></li>
<li><p>Episode 4: http://www.youtube.com/watch?v=pv25aLwYpEU</p></li>
<li><p>[http://progit.org/ Pro Git], an online and published book</p></li>
<li><p>[http://youtu.be/ZDR433b0HJY Introduction to Git] video with Scott Chacon of GitHub</p></li>
</ul>

<h1 id="appendixa:notesforteachersandgroupfaciltators">Appendix A: Notes for Teachers and group faciltators</h1>

<p>Git is a useful platform for students to work together. Additional if their programming work needs to be accessed then it
provides a useful mechanism for students and teams to submit their work.</p>

<p>Students can collaborate using four different models:</p>

<ol>
<li>Using a third party service such as GitHub, Gitorious or BitBucket. Examples are given below for GitHub</li>
<li>Via a private server provided by the school. This is beyond the scope of this document</li>
<li>Students can exchange work using a peer to peer model. This requires a local area for the students to exchange work #todo Add notes on remote</li>
<li>Students can exchange using Git patches on USB drives (a <strong>sneakernet</strong>). This is most technology simple solution but
is more complicated for students and is beyond the scope of this document</li>
</ol>

<h2 id="usingathirdpartywebhostingservice.github">Using a third party web hosting service. GitHub</h2>

<p>(GitHub)[GitHub.com] provide specific git hosting service for schools. see https://github.com/edu for details.</p>

<ol>
<li>Create a a GitHub organisation for your school or organisation</li>
<li>Let GitHub know the details of your account using the form at https://github.com/edu.
This will allow your students to have private repos.
N.B. Normally all free accounts are public and the code they contain in freely available.</li>
<li>Your students should create their own account on GitHub (see Appendix B). Students can follow the instructions at http://help.github.com/</li>
<li>You then add your students to the appropriate GitHub organisation</li>
</ol>

<h1 id="appendixb:notesforselfstudystudents">Appendix B: Notes for self study students</h1>

<p>Students are recommended to use a remote hosting account fo their code. It develops good technique and provides a useful back up</p>

<p>There are a variety of free services available (see appendix A for some suggestions).
GitHub has easy to follow instructions at http://help.github.com/</p>

<h1 id="license">License</h1>

<p>This work is licensed under the Creative Commons Attribution-ShareAlike 3.0 Unported License.
To view a copy of this license, read the contents of the file LICENSE distributed with the source of this material,
visit http://creativecommons.org/licenses/by-sa/3.0/ or send a letter to
Creative Commons, 444 Castro Street, Suite 900, Mountain View, California, 94041, USA.</p>
